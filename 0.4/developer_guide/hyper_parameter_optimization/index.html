
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Deep learning toolbox">
      
      
        <meta name="author" content="Piero Molino">
      
      
        <link rel="canonical" href="https://ludwig-ai.github.io/ludwig-docs/0.4/developer_guide/hyper_parameter_optimization/">
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Hyper-parameter Optimization - Ludwig</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#757575">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/monokai.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="grey">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adding-a-hyperoptsampler" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ludwig" class="md-header__button md-logo" aria-label="Ludwig" data-md-component="logo">
      
<img alt="logo" src="../../images/ludwig_logo.svg"
     style="height:1rem;width:4rem;">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ludwig
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hyper-parameter Optimization
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ludwig-ai/ludwig/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ludwig-ai/ludwig
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../getting_started/" class="md-tabs__link">
      Getting Started
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../user_guide/" class="md-tabs__link">
        User Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../configuration/" class="md-tabs__link">
        Configuration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Developer Guide
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../community/" class="md-tabs__link">
      Community
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../faq/" class="md-tabs__link">
      FAQ
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ludwig" class="md-nav__button md-logo" aria-label="Ludwig" data-md-component="logo">
      
<img alt="logo" src="../../images/ludwig_logo.svg"
     style="height:1rem;width:4rem;">

    </a>
    Ludwig
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ludwig-ai/ludwig/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ludwig-ai/ludwig
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../user_guide/">User Guide</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/command_line_interface/" class="md-nav__link">
        Command Line Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Python API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python API" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Python API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/api/LudwigModel/" class="md-nav__link">
        LudwigModel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/api/visualization/" class="md-nav__link">
        Visualization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_4">
          Datasets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Datasets" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/datasets/supported_formats/" class="md-nav__link">
        Supported Formats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/datasets/data_preprocessing/" class="md-nav__link">
        Data Preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/datasets/data_postprocessing/" class="md-nav__link">
        Data Postprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/datasets/dataset_zoo/" class="md-nav__link">
        Dataset Zoo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/distributed_training/" class="md-nav__link">
        Distributed Training
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/hyperopt/" class="md-nav__link">
        Hyperparameter Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/automl/" class="md-nav__link">
        AutoML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/visualizations/" class="md-nav__link">
        Visualizations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/serving/" class="md-nav__link">
        Serving
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/integrations/" class="md-nav__link">
        Third-Party Integrations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../configuration/">Configuration</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Features" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/input_features/" class="md-nav__link">
        Input Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/output_features/" class="md-nav__link">
        Output Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/numerical_features/" class="md-nav__link">
        Numerical Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/category_features/" class="md-nav__link">
        Category Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/binary_features/" class="md-nav__link">
        Binary Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/text_features/" class="md-nav__link">
        Text Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/image_features/" class="md-nav__link">
        Image Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/audio_features/" class="md-nav__link">
        Audio Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/sequence_features/" class="md-nav__link">
        Sequence Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/set_features/" class="md-nav__link">
        Set Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/bag_features/" class="md-nav__link">
        Bag Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/date_features/" class="md-nav__link">
        Date Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/h3_features/" class="md-nav__link">
        H3 Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/time_series_features/" class="md-nav__link">
        Time Series Features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/features/vector_features/" class="md-nav__link">
        Vector Features
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/combiner/" class="md-nav__link">
        Combiner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/preprocessing/" class="md-nav__link">
        Preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/training/" class="md-nav__link">
        Training
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/hyperparameter_optimization/" class="md-nav__link">
        Hyperopt
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../examples/">Examples</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/text_classification/" class="md-nav__link">
        Text Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ner_tagging/" class="md-nav__link">
        Named Entity Recognition Tagging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/nlu/" class="md-nav__link">
        Natural Language Understanding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/machine_translation/" class="md-nav__link">
        Machine Translation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/seq2seq/" class="md-nav__link">
        Chit-Chat Dialogue Modeling through Sequence2Sequence
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/sentiment_analysis/" class="md-nav__link">
        Sentiment Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/image_classification/" class="md-nav__link">
        Image Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mnist/" class="md-nav__link">
        Image Classification (MNIST)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/oneshot/" class="md-nav__link">
        One-shot Learning with Siamese Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/visual_qa/" class="md-nav__link">
        Visual Question Answering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/speech_recognition/" class="md-nav__link">
        Spoken Digit Speech Recognition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/speaker_verification/" class="md-nav__link">
        Speaker Verification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/titanic/" class="md-nav__link">
        Binary Classification (Titanic)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/forecasting/" class="md-nav__link">
        Timeseries forecasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/weather/" class="md-nav__link">
        Timeseries forecasting (Weather)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/movie_ratings/" class="md-nav__link">
        Movie rating prediction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/multi_label/" class="md-nav__link">
        Multi-label classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/multi_task/" class="md-nav__link">
        Multi-Task Learning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/fuel_efficiency/" class="md-nav__link">
        Simple Regression: Fuel Efficiency Prediction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/fraud/" class="md-nav__link">
        Fraud Detection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Developer Guide</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Developer Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Developer Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../codebase_structure/" class="md-nav__link">
        Codebase Structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_an_encoder/" class="md-nav__link">
        Add an Encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_a_decoder/" class="md-nav__link">
        Add a Decoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_a_feature_type/" class="md-nav__link">
        Add a Feature Type
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Hyper-parameter Optimization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Hyper-parameter Optimization
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adding-a-hyperoptsampler" class="md-nav__link">
    Adding a HyperoptSampler
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-sampler-class" class="md-nav__link">
    1. Add a new sampler class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new sampler class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample" class="md-nav__link">
    sample
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_batch" class="md-nav__link">
    sample_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_batch" class="md-nav__link">
    update_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finished" class="md-nav__link">
    finished
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-sampler-class-to-the-corresponding-sampler-registry" class="md-nav__link">
    2. Add the new sampler class to the corresponding sampler registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-hyperoptexecutor" class="md-nav__link">
    Adding a HyperoptExecutor
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-executor-class" class="md-nav__link">
    1. Add a new executor class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new executor class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___1" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute" class="md-nav__link">
    execute
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-executor-class-to-the-corresponding-executor-registry" class="md-nav__link">
    2. Add the new executor class to the corresponding executor registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_an_integration/" class="md-nav__link">
        Add an Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_a_dataset/" class="md-nav__link">
        Add an Dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../style_guidelines_and_tests/" class="md-nav__link">
        Style Guidelines and Tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../unit_test_design_guidelines/" class="md-nav__link">
        Unit Test Design Guidelines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adding-a-hyperoptsampler" class="md-nav__link">
    Adding a HyperoptSampler
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-sampler-class" class="md-nav__link">
    1. Add a new sampler class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new sampler class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample" class="md-nav__link">
    sample
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_batch" class="md-nav__link">
    sample_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_batch" class="md-nav__link">
    update_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finished" class="md-nav__link">
    finished
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-sampler-class-to-the-corresponding-sampler-registry" class="md-nav__link">
    2. Add the new sampler class to the corresponding sampler registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-hyperoptexecutor" class="md-nav__link">
    Adding a HyperoptExecutor
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-executor-class" class="md-nav__link">
    1. Add a new executor class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new executor class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___1" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute" class="md-nav__link">
    execute
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-executor-class-to-the-corresponding-executor-registry" class="md-nav__link">
    2. Add the new executor class to the corresponding executor registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/ludwig-ai/ludwig-docs/edit/master/src/docs/developer_guide/hyper_parameter_optimization.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



  <h1>Hyper-parameter Optimization</h1>

<p>The hyper-parameter optimization design in Ludwig is based on two abstract interfaces: <code>HyperoptSampler</code> and <code>HyperoptExecutor</code>.</p>
<p><code>HyperoptSampler</code> represents the sampler adopted for sampling hyper-parameters values.
Which sampler to use is defined in the <code>sampler</code> section of the model definition.
A <code>Sampler</code> uses the <code>parameters</code> defined in the <code>hyperopt</code> section of the YAML model definition and a <code>goal</code> , either to minimize or maximize.
Each sub-class of <code>HyperoptSampler</code> that implements its abstract methods samples parameters according to their definition and type differently (see <a href="../../user_guide/hyperopt/">User Guide</a> for details), like using a random search (implemented in <code>RandomSampler</code>), or a grid serach (implemented in <code>GridSampler</code>, or bayesian optimization or evolutionary techniques.</p>
<p><code>HyperoptExecutor</code> represents the method used to execute the hyper-parameter optimization, independently of how the values for the hyperparameters are sampled.
Available implementations are a serial executor that executes the training with the different sampled hyper-parameters values one at a time (implemented in <code>SerialExecutor</code>), a parallel executor that runs the training using sampled hyper-parameters values in parallel on the same machine (implemented in the <code>ParallelExecutor</code>), and a <a href="https://uber.github.io/fiber/">Fiber</a>-based executor that enables to run the training using sampled hyper-parameters values in parallel on multiple machines within a cluster.
A <code>HyperoptExecutor</code> uses a <code>HyperoptSampler</code> to sample hyper-parameters values, usually initializes an execution context, like a multithread pool for instance, and executes the hyper-parameter optimization according to the sampler.
First, a new batch of parameters values is sampled from the <code>HyperoptSampler</code>.
Then, sampled parameters values are merged with the basic model definition parameters specified, with the sampled parameters values overriding the ones in the basic model definition they refer to.
Training is executed using the merged model definition and training and validation losses and metrics are collected.
A <code>(sampled_parameters, statistics)</code> pair is provided to the <code>HyperoptSampler.update</code> function and the loop is repeated until all the samples are sampled.
At the end, <code>HyperoptExecutor.execute</code> returns a list of dictionaries that include a parameter sample, its metric score, and its training and test statistics.
The returned list is printed and saved to disk, so that it can also be used as input to <a href="../../user_guide/hyperopt/">hyper-parameter optimization visualizations</a>.</p>
<h2 id="adding-a-hyperoptsampler">Adding a HyperoptSampler<a class="headerlink" href="#adding-a-hyperoptsampler" title="Permanent link">&para;</a></h2>
<h3 id="1-add-a-new-sampler-class">1. Add a new sampler class<a class="headerlink" href="#1-add-a-new-sampler-class" title="Permanent link">&para;</a></h3>
<p>The source code for the base <code>HyperoptSampler</code> class is in the <code>ludwig/hyperopt/sampling.py</code> module.
Classes extending the base class should be defined in the same module.</p>
<h5 id="__init__"><code>__init__</code><a class="headerlink" href="#__init__" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
</code></pre></div>

<p>The parameters of the base <code>HyperoptStrategy</code> class constructor are:</p>
<ul>
<li><code>goal</code> which indicates if to minimize or maximize a metric or a loss of any of the output features on any of the splits which is defined in the <code>hyperopt</code> section</li>
<li><code>parameters</code> which contains all hyper-parameters to optimize with their types and ranges / values.</li>
</ul>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">goal</span> <span class="o">=</span> <span class="s2">&quot;minimize&quot;</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;training.learning_rate&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span>
        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;combiner.num_fc_layers&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span>
        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">GridSampler</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
</code></pre></div>

<h5 id="sample"><code>sample</code><a class="headerlink" href="#sample" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</code></pre></div>

<p><code>sample</code> is a method that yields a new sample according to the sampler.
It returns a set of parameters names and their values.
If <code>finished()</code> returns <code>True</code>, calling <code>sample</code> would return a <code>IndexError</code>.</p>
<p>Example returned value:</p>
<div class="codehilite"><pre><span></span><code>{&#39;training.learning_rate&#39;: 0.005, &#39;combiner.num_fc_layers&#39;: 2, &#39;utterance.cell_type&#39;: &#39;gru&#39;}
</code></pre></div>

<h5 id="sample_batch"><code>sample_batch</code><a class="headerlink" href="#sample_batch" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">sample_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
</code></pre></div>

<p><code>sample_batch</code> method returns a list of sampled parameters of length equal to or less than <code>batch_size</code>.
If <code>finished()</code> returns <code>True</code>, calling <code>sample_batch</code> would return a <code>IndexError</code>.</p>
<p>Example returned value:</p>
<div class="codehilite"><pre><span></span><code>[{&#39;training.learning_rate&#39;: 0.005, &#39;combiner.num_fc_layers&#39;: 2, &#39;utterance.cell_type&#39;: &#39;gru&#39;}, {&#39;training.learning_rate&#39;: 0.015, &#39;combiner.num_fc_layers&#39;: 3, &#39;utterance.cell_type&#39;: &#39;lstm&#39;}]
</code></pre></div>

<h5 id="update"><code>update</code><a class="headerlink" href="#update" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sampled_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">metric_score</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">):</span>
</code></pre></div>

<p><code>update</code> updates the sampler with the results of previous computation.</p>
<ul>
<li><code>sampled_parameters</code> is a dictionary of sampled parameters.</li>
<li><code>metric_score</code> is the value of the optimization metric obtained for the specified sample.</li>
</ul>
<p>It is not needed for stateless strategies like grid and random, but is needed for stateful strategies like bayesian and evolutionary ones.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sampled_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;training.learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="s1">&#39;combiner.num_fc_layers&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
    <span class="s1">&#39;utterance.cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gru&#39;</span>
<span class="p">}</span> 
<span class="n">metric_score</span> <span class="o">=</span> <span class="mf">2.53463</span>

<span class="n">sampler</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sampled_parameters</span><span class="p">,</span> <span class="n">metric_score</span><span class="p">)</span>
</code></pre></div>

<h5 id="update_batch"><code>update_batch</code><a class="headerlink" href="#update_batch" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_batch</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameters_metric_tuples</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span>
<span class="p">):</span>
</code></pre></div>

<p><code>update_batch</code> updates the sampler with the results of previous computation in batch.</p>
<ul>
<li><code>parameters_metric_tuples</code> a list of pairs of sampled parameters and their respective metric value.</li>
</ul>
<p>It is not needed for stateless strategies like grid and random, but is needed for stateful strategies like bayesian and evolutionary ones.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sampled_parameters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;training.learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
        <span class="s1">&#39;combiner.num_fc_layers&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
        <span class="s1">&#39;utterance.cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gru&#39;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;training.learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.015</span><span class="p">,</span>
        <span class="s1">&#39;combiner.num_fc_layers&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> 
        <span class="s1">&#39;utterance.cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;lstm&#39;</span>
    <span class="p">}</span>
<span class="p">]</span>
<span class="n">metric_scores</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.53463</span><span class="p">,</span> <span class="mf">1.63869</span><span class="p">]</span>

<span class="n">sampler</span><span class="o">.</span><span class="n">update_batch</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sampled_parameters</span><span class="p">,</span> <span class="n">metric_scores</span><span class="p">))</span>
</code></pre></div>

<h5 id="finished"><code>finished</code><a class="headerlink" href="#finished" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">finished</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</code></pre></div>

<p>The <code>finished</code> method return <code>True</code> when all samples have been sampled, return <code>False</code> otherwise.</p>
<h3 id="2-add-the-new-sampler-class-to-the-corresponding-sampler-registry">2. Add the new sampler class to the corresponding sampler registry<a class="headerlink" href="#2-add-the-new-sampler-class-to-the-corresponding-sampler-registry" title="Permanent link">&para;</a></h3>
<p>The <code>sampler_registry</code> contains a mapping between <code>sampler</code> names in the <code>hyperopt</code> section of model definition and <code>HyperoptSampler</code> sub-classes.
To make a new sampler available, add it to the registry:</p>
<div class="codehilite"><pre><span></span><code>sampler_registry = {
    &quot;random&quot;: RandomSampler,
    &quot;grid&quot;: GridSampler,
    ...,
    &quot;new_sampler_name&quot;: NewSamplerClass
}
</code></pre></div>

<h2 id="adding-a-hyperoptexecutor">Adding a HyperoptExecutor<a class="headerlink" href="#adding-a-hyperoptexecutor" title="Permanent link">&para;</a></h2>
<h3 id="1-add-a-new-executor-class">1. Add a new executor class<a class="headerlink" href="#1-add-a-new-executor-class" title="Permanent link">&para;</a></h3>
<p>The source code for the base <code>HyperoptExecutor</code> class is in the <code>ludwig/utils/hyperopt_utils.py</code> module.
Classes extending the base class should be defined in the module.</p>
<h5 id="__init___1"><code>__init__</code><a class="headerlink" href="#__init___1" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">hyperopt_sampler</span><span class="p">:</span> <span class="n">HyperoptSampler</span><span class="p">,</span>
    <span class="n">output_feature</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">split</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>

<p>The parameters of the base <code>HyperoptExecutor</code> class constructor are</p>
<ul>
<li><code>hyperopt_sampler</code> is a <code>HyperoptSampler</code> object that will be used to sample hyper-parameters values</li>
<li><code>output_feature</code> is a <code>str</code> containing the name of the output feature that we want to optimize the metric or loss of. Available values are <code>combined</code> (default) or the name of any output feature provided in the model definition. <code>combined</code> is a special output feature that allows to optimize for the aggregated loss and metrics of all output features.</li>
<li><code>metric</code> is the metric that we want to optimize for. The default one is <code>loss</code>, but depending on the tye of the feature defined in <code>output_feature</code>, different metrics and losses are available. Check the metrics section of the specific output feature type to figure out what metrics are available to use.</li>
<li><code>split</code> is the split of data that we want to compute our metric on. By default it is the <code>validation</code> split, but you have the flexibility to specify also <code>train</code> or <code>test</code> splits.</li>
</ul>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">goal</span> <span class="o">=</span> <span class="s2">&quot;minimize&quot;</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;training.learning_rate&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;combiner.num_fc_layers&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">3</span>
            <span class="p">}</span>
        <span class="p">}</span>
<span class="n">output_feature</span> <span class="o">=</span> <span class="s2">&quot;combined&quot;</span>
<span class="n">metric</span> <span class="o">=</span> <span class="s2">&quot;loss&quot;</span>
<span class="n">split</span> <span class="o">=</span> <span class="s2">&quot;validation&quot;</span>

<span class="n">grid_sampler</span> <span class="o">=</span> <span class="n">GridSampler</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">SerialExecutor</span><span class="p">(</span><span class="n">grid_sampler</span><span class="p">,</span> <span class="n">output_feature</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span>
</code></pre></div>

<h5 id="execute"><code>execute</code><a class="headerlink" href="#execute" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">config</span><span class="p">,</span>
    <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">training_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">test_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">training_set_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;hyperopt&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;run&quot;</span><span class="p">,</span>
    <span class="n">model_load_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">model_resume_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">skip_save_training_description</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_training_statistics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_processed_input</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_unprocessed_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_eval_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;results&quot;</span><span class="p">,</span>
    <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">gpu_memory_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_parallel_threads</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">use_horovod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="n">default_random_seed</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
</code></pre></div>

<p>The <code>execute</code> method executes the hyper-parameter optimization.
It can leverage the <code>run_experiment</code> function to obtain training and eval statistics and the <code>self.get_metric_score</code> function to extract the metric score from the eval results according to <code>self.output_feature</code>, <code>self.metric</code> and <code>self.split</code>.</p>
<h3 id="2-add-the-new-executor-class-to-the-corresponding-executor-registry">2. Add the new executor class to the corresponding executor registry<a class="headerlink" href="#2-add-the-new-executor-class-to-the-corresponding-executor-registry" title="Permanent link">&para;</a></h3>
<p>The <code>executor_registry</code> contains a mapping between <code>executor</code> names in the <code>hyperopt</code> section of model definition and <code>HyperoptExecutor</code> sub-classes.
To make a new executor available, add it to the registry:</p>
<div class="codehilite"><pre><span></span><code>executor_registry = {
    &quot;serial&quot;: SerialExecutor,
    &quot;parallel&quot;: ParallelExecutor,
    &quot;fiber&quot;: FiberExecutor,
    &quot;new_executor_name&quot;: NewExecutorClass
}
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        

<!-- Application footer -->
<footer class="md-footer">

    <!-- Link to previous and/or next page -->
    
    <div class="md-footer-nav">
        <nav aria-label="Footer"
             class="md-footer-nav__inner md-grid">
            
            <a class="md-footer-nav__link md-footer-nav__link--prev"
               href="../add_a_feature_type/" rel="prev"
               title="Add a Feature Type">
                <div class="md-footer-nav__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
                </div>
                <div class="md-footer-nav__title">
                    <div class="md-ellipsis">
                 <span class="md-footer-nav__direction">
                   Previous
                 </span>
                        Add a Feature Type
                    </div>
                </div>
            </a>
            
            
            <a class="md-footer-nav__link md-footer-nav__link--next"
               href="../add_an_integration/" rel="next"
               title="Add an Integration">
                <div class="md-footer-nav__title">
                    <div class="md-ellipsis">
                 <span class="md-footer-nav__direction">
                   Next
                 </span>
                        Add an Integration
                    </div>
                </div>
                <div class="md-footer-nav__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
                </div>
            </a>
            
        </nav>
    </div>
    

    <!-- Further information -->
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">

            <!-- Copyright and theme information -->
            <div class="md-footer-copyright">
                <div class="footer-logo-smallpad"></div>
                
                <div class="md-footer-copyright__highlight">
                    Copyright &copy; 2018 - 2020 Uber Technologies Inc., 2021 Linux Foundation Data & AI
                </div>
                
                Website by <a href="http://w4nderlu.st">w4nderlust</a> powered by
                <a href="https://www.mkdocs.org">MkDocs</a>,
                <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a>,
                <a href="http://www.styleshout.com/">styleshout</a> and
                <a href="http://cables.gl/">cables</a>.
            </div>

            <!-- Social links -->
            
            <div class="md-social">
  
</div>
            
        </div>
    </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>